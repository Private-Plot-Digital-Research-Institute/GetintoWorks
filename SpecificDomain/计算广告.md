![[广告系统架构.canvas]]

整体流程： 召回-粗排-精排-重排
冷启动

用户请求响应：

检索出广告列表-> Scoring -> 广告过滤、TopN截断 -> 查询ID化数据并填充



## 广告算法

### 召回

根据关键词获取广告

召回率： $\frac{广告系统检索出匹配用户的广告}{广告库中匹配用户的广告}$

可能降低召回率的原因


#### 广告定向



### 自动扩量

#### 近邻检索

[一文纵览KNN（ANN）向量检索 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/264367144)

常见的向量度量有四种：欧式距离、余弦、内积、海明距离

不同的度量方式对应不同的场景，通常欧式距离用于图片检索，余弦用于人脸识别，内积多用于推荐，海明距离由于向量比较小，通常用于大规模视频检索场景。

#### 向量检索索引

##### 基于树的方法
![[Pasted image 20230918135302.jpg]]

##### 基于图的方法

HNSW背后其实是跳表在图上的应用，跳表作为一种简单高效的索引结构在Redis、LevelDB等系统中获得广泛应用，如图3所示

![[v2-e01affcc4da043681738b44403425ae8_1440w.webp]]


##### 基于哈希的方法

哈希指的是局部敏感哈希（Locality Sensitive Hashing，LSH），不同于传统哈希尽量不产生碰撞，局部敏感哈希依赖碰撞来查找近邻。

满足如下两个条件的哈希函数称为（d1,d2,p1,p2）-sensitive：

1. 如果d(x,y) <= d1，则h(x) = h(y)的概率至少为p1；

2. 如果d(x,y) >= d2，则h(x) = h(y)的概率最多为p2；

### 图神经网络


### 粗排

#### 排序策略

$$
eCPM = pCTR \times CPC \times 1000
$$

eCPM: 千次曝光成本
pCTR: 预估点击率
CPC： 每次点击出价

### 与推荐系统区别

- 标签竞争的不均衡带来收入损失

商品广告曝光到竞争不充分的标签，使得单次点击出价降低

### 冷启动

模型对于新广告预估不准，起量成功率低，无法获得足够曝光

解决方案： 设立商品广告的学习期

学习期->稳定期



## 推荐算法

[(12 封私信 / 80 条消息) 推荐算法工程师需要掌握哪些核心技能点？ - 知乎 (zhihu.com)](https://www.zhihu.com/question/365832794/answer/2405124139)

### 数据不平衡问题

不平衡的数据会导致对少数类表现不佳的有偏模型。为了处理不平衡数据，你可以使用过采样少数类、欠采样多数类或使用SMOTE等合成数据生成方法。此外，你可以使用成本敏感学习，其中为每个类别分配不同的分类成本，或者使用更鲁棒于类别不平衡的精确度、召回率和F1得分等评估指标。

#### SMOTE， 成本敏感学习



## 高性能计算

### 消息队列， 分布式锁

[[Message Queue,Distributed Lock]]

## 数学基础

### 泊松分布

$$
p(X = k; \lambda) = \frac{e^{-\lambda}\lambda^k}k!
$$
